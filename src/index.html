<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XTC.js</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@400;500&family=Libre+Franklin:wght@400;500;700;900&display=swap" rel="stylesheet">
</head>
<body>
  <div class="grain"></div>

  <main class="layout">
    <header class="header">
      <div class="logo">
        <span class="logo-xtc">XTC</span><span class="logo-dot">.</span><span class="logo-js">js</span>
      </div>
      <p class="tagline">Manga converter for <em>XTEink X4</em> · Support by starring on <a href="https://github.com/varo6/xtcjs" target="_blank" rel="noopener" style="color: inherit;">GitHub</a> ♥</p>
    </header>

    <section class="dropzone-wrapper">
      <div id="dropzone" class="dropzone" tabindex="0">
        <div class="dropzone-inner">
          <div class="dropzone-icon">
            <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="8" y="8" width="32" height="32" rx="2"/>
              <path d="M16 28l8-8 8 8"/>
              <path d="M24 20v16"/>
            </svg>
          </div>
          <div class="dropzone-text">
            <span class="dropzone-primary">Drop CBZ files</span>
            <span class="dropzone-secondary">or click to browse</span>
          </div>
        </div>
        <input type="file" id="fileInput" accept=".cbz,.CBZ" multiple hidden>
      </div>
    </section>

    <section id="fileList" class="file-list hidden">
      <div class="section-header">
        <h2>Files</h2>
        <span id="fileCount" class="badge">0</span>
      </div>
      <div id="files" class="files-grid"></div>
      <button id="convertBtn" class="btn-convert">
        <span>Convert</span>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </button>
    </section>

    <aside class="options-panel">
      <div class="section-header">
        <h2>Options</h2>
      </div>

      <div class="option">
        <label for="splitMode">Page Split</label>
        <select id="splitMode">
          <option value="overlap" selected>Overlapping thirds</option>
          <option value="split">Split in half</option>
          <option value="nosplit">No split</option>
        </select>
      </div>

      <div class="option">
        <label for="dithering">Dithering</label>
        <select id="dithering">
          <option value="floyd" selected>Floyd-Steinberg</option>
          <option value="atkinson">Atkinson</option>
          <option value="sierra-lite">Sierra Lite</option>
          <option value="ordered">Ordered</option>
          <option value="none">None</option>
        </select>
      </div>

      <div class="option">
        <label for="contrast">Contrast</label>
        <select id="contrast">
          <option value="0">None</option>
          <option value="2">Light</option>
          <option value="4" selected>Medium</option>
          <option value="6">Strong</option>
          <option value="8">Maximum</option>
        </select>
      </div>

      <div class="option">
        <label for="margin">Margin crop</label>
        <div class="input-with-unit">
          <input type="number" id="margin" min="0" max="20" value="0" step="0.5">
          <span class="unit">%</span>
        </div>
      </div>
    </aside>

    <section id="progress" class="progress-section hidden">
      <div class="progress-header">
        <span id="progressText">Processing...</span>
        <span id="progressPercent">0%</span>
      </div>
      <div class="progress-track">
        <div id="progressBar" class="progress-fill"></div>
      </div>
      <div id="currentPage" class="preview-container"></div>
    </section>

    <section id="results" class="results-section hidden">
      <div class="section-header">
        <h2>Complete</h2>
      </div>
      <div id="resultsList" class="results-grid"></div>
    </section>

    <section id="viewer" class="viewer-section hidden">
      <div class="viewer-header">
        <div class="section-header">
          <h2>Preview</h2>
          <span id="pageIndicator" class="badge">1 / 1</span>
        </div>
        <div class="viewer-controls">
          <button id="viewerRotate" class="viewer-btn" aria-label="Rotate view">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
              <path d="M21 3v5h-5"/>
            </svg>
          </button>
          <div class="viewer-separator"></div>
          <button id="viewerPrev" class="viewer-btn" aria-label="Previous page">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
          <button id="viewerNext" class="viewer-btn" aria-label="Next page">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
          <button id="viewerClose" class="viewer-btn viewer-btn-close" aria-label="Close viewer">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="viewer-container">
        <div id="viewerTrack" class="viewer-track"></div>
      </div>
      <div class="viewer-thumbnails">
        <div id="thumbnailTrack" class="thumbnail-track"></div>
      </div>
    </section>

    <footer class="footer">
      <p>All processing happens in your browser</p>
      <a href="https://github.com/tazua/cbz2xtc" target="_blank" rel="noopener">Based on cbz2xtc</a>
    </footer>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script type="module" src="./main.ts"></script>
</body>
</html>
